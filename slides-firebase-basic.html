<!--
@Author: Nicolas Fazio <webmaster-fazio>
@Date:   09-01-2017
@Email:  contact@nicolasfazio.ch
@Last modified by:   webmaster-fazio
@Last modified time: 11-01-2017
-->

<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>[Formation] Firebase Basic: Slides</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/white.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">
		<link rel="stylesheet" href="css/default.css">
		<link rel="stylesheet" href="css/firebase.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section data-background-color="#039be5">
						<img height="350px" src="https://s3.amazonaws.com/media-p.slid.es/uploads/559385/images/2976546/Firebase_16-logo.png" alt="">
						<br>
						<h2>Google Firebase</h2>
						<h3>- Basic -</h3>
						<p>
							<small>Nicolas Fazio <br><a href="http://twitter.com/FazioNico">@FazioNico</a></small>
						</p>
				</section>

				<section class="text-left section-fb">
					<h2>Programme</h2>
					<p>
						Présentation de Firebase <br>
						Le model NoSQL <br>
						Installation <br>
						Connection au serveur <br>
						Real-Time-Database <br>
						Organisation des donnée <br>
						User Authentification <br>
						Gestion des droits et sécurité
					</p>
				</section>

				<section>
					<section data-background-color="#039be5">
						<img height="350px" src="https://s3.amazonaws.com/media-p.slid.es/uploads/559385/images/2976546/Firebase_16-logo.png" alt="">
						<h2>Présentation de Firebase</h2>
					</section>

					<section class="text-left section-fb">
						<h2>Firebase en quelques mots</h2>
						<br>
						<p>
							Firebase est un outil en ligne qui permet de stocker des données ou des fichiers et d'authentifier les utilisateurs d'une application.
						</p>
						<p>
							L'idée est de proposer une zone Back-End en Javascript pour le développement d'application et le stockage des informations.
						</p>
						<p>
							Site officiel: <a href="https://firebase.google.com/">https://firebase.google.com/</a>
						</p>
					</section>

					<section class="text-left section-fb">
						<h2>Les BBDD NoSQL</h2>
						<br>
						<p>
							NoSQL ne veut pas dire que ce n'est un model de stockage de donnée SQL,  mais que ce n'est pas QUE un model SQL !
							<br><b>NoSQL =  NotOnlySQL</b>
						</p>
						<p>
							Ce model de gestion des données est apparu pour palier au désaventage du model de gestion SQL.
						</p>
						<p>
							Voici en illustration simplifiée ce qui change:
						</p>
					</section>

					<section class="section-fb">
						<h2>SQL vs NoSQL</h2>
						<br>
						<table>
							<thead>
								<tr>
									<th>Item</th>
									<th>Price</th>
									<th>Quantity</th>
									<th>Status</th>
								</tr>
							</thead>
							<tbody>
								<tr class="green">
									<td>Apples</td>
									<td>$1</td>
									<td>7</td>
									<td>null</td>
								</tr>
								<tr class="blue">
									<td>Banane</td>
									<td>$2</td>
									<td>18</td>
									<td>null</td>
								</tr>
								<tr class="purple">
									<td>Audi</td>
									<td>$80'000</td>
									<td>2</td>
									<td>neuf</td>
								</tr>
								<tr class="red">
									<td>Fial</td>
									<td>$12'000</td>
									<td>2</td>
									<td>occasion</td>
								</tr>
							</tbody>
						</table>
					</section>

					<section class="section-fb">
						<h2 class="text-left">SQL vs NoSQL</h2>
						<br>
						<div class="nosqlItem green">
							<pre>
{
  Item: 'pomme',
  price: '1.-',
  Quantity: '7'
}
							</pre>
						</div>
						<div class="nosqlItem blue">
							<pre>
{
  Item: 'banane',
  price: '1.-',
  Quantity: '18'
}
							</pre>
						</div>
						<div class="nosqlItem purple">
							<pre>
{
  Item: 'audi',
  price: '80'000.-',
  Quantity: '2',
  status: 'neuf'
}
							</pre>

						</div>
						<div class="nosqlItem red">
							<pre>
{
  Item: 'fiat',
  price: '12'000.-',
  Quantity: '2',
  status: 'occasion'
}
							</pre>
						</div>
					</section>
				</section>

				<section>
						<section data-background-color="#039be5">
						<img height="350px" src="https://s3.amazonaws.com/media-p.slid.es/uploads/559385/images/2976546/Firebase_16-logo.png" alt="">
						<h2>Utiliser Firebase avec un projet Javascript</h2>
					</section>

					<section class="section-fb text-left">
						<h2>Installation de Firebase et connection au serveur</h2>
						<br>
						<p>
							Aller sur le site officiel: <br>
							<a href="https://firebase.google.com/">https://firebase.google.com/</a> <br>
							Cliquer sur <b>connexion</b> et <b>se connecter</b> ou <b>créer un compte</b>, puis sur <b>accéder à la console</b> et enfin sur <b>créer un projet</b>.
						</p>
						<p>
							Choisir ensuite <b>ajouter Firebase à votre app web</b>.
							Firebase génère tout seul le code d'intégration!
							<b>Copier et coller</b> le code javascript dans votre fichier <b>index.html</b>
						</p>
						<p>
							C'est tout ;-)
						</p>
					</section>

					<section class="section-fb text-left">
						<h2>Utilisation de Firebase</h2>
						<br>
						<p>
							<b>firebase.database()</b> <br>
							Stockez et synchronisez des données en temps réel sur tous les clients connectés.
						</p>
						<p>
							<b>firebase.auth()</b> <br>
							Authentifiez et gérez les utilisateurs à partir de plusieurs fournisseurs sans code côté serveur.
						</p>
						<p>
							Doc officiel pour WebApp: <br>
							<a href="https://firebase.google.com/docs/web/setup​">https://firebase.google.com/docs/web/setup​</a>
						</p>
					</section>
				</section>

				<section>
					<section data-background-color="#039be5">
						<img height="350px" src="https://s3.amazonaws.com/media-p.slid.es/uploads/559385/images/2976546/Firebase_16-logo.png" alt="">
						<h2>Firebase RealTime DataBase</h2>
					</section>

					<section class="section-fb text-left">
						<h2>Connection à la base de donnée</h2>
						<br>
						<p>
							Firebase RealTime Database est une base de données hébergée sur un cloud. Les données sont stockées au format JSON et synchronisé en temps réel à chaque client connecté.
						</p>
						<p>
							<b>Pour accéder à votre base de donnée:</b> <br>
							- initialliser Firebase puis: <br>
							<pre>let database = firebase.database();	</pre>
						</p>
					</section>

					<section class="section-fb text-left">
						<h2>Connection à la base de donnée</h2>
						<br>
						<p>
							Voici ce que cela donne:
						</p>
						<pre><code class="javascript" data-trim >
// Set the configuration for your app
// TODO: Replace with your project's config object
let config = {
  apiKey: "apiKey",
  authDomain: "projectId.firebaseapp.com",
  databaseURL: "https://databaseName.firebaseio.com",
  storageBucket: "bucket.appspot.com"
};
firebase.initializeApp(config);

// Get a reference to the database service
let database = firebase.database();
						</code></pre>
						<br>
						<p>
							Maintenant la base de donnée Firebase est prête à être utilisée.
						</p>
					</section>
				</section>

				<section data-background-color="#039be5">
					<h2>TP</h2>
					<br>
					<ul>
						<li>Créer un projet 'firebase-training' sur firebase.google.com</li>
						<li>Créer un fichier index.html et y intégrer le projet Firebase 'firebase-training'</li>
						<li>Se connecter à votre RealTime Database</li>
					</ul>
				</section>

				<section>
					<section data-background-color="#039be5">
						<img height="350px" src="https://s3.amazonaws.com/media-p.slid.es/uploads/559385/images/2976546/Firebase_16-logo.png" alt="">
						<h2>Organiser et structurer la base de donnée</h2>
					</section>

					<section class="section-fb text-left">
						<h2>Organiser et structurer la base de donnée</h2>
						<br>
						<p>
							Concevoir une bonne organisation structurelle de votre base de donnée demande de la reflexion et de savoir dans que contexte les informations vont être utilisées (use case).
						</p>
						<p>
							Sans quoi vous allez continuellement réorganiser votre structure de data et donc perdre du temps sur le développement de votre application.
						</p>
					</section>

					<section class="section-fb text-left">
						<h2>Organisation "Flat"</h2>
						<br>
						<p>
							Lorsque vous récupérez des données à un emplacement dans votre base de données, <b>vous récupérez également tous ses nœuds enfants</b>.
						</p>
						<p>
							Et quand vous accordez à quelqu'un l'accès pour lire ou écrire un noeud dans votre base de données, <b>vous leur accordez également l'accès à toutes les données sous ce nœud</b>.
						</p>
						<p>
							C'est pourquoi , il est préférable de garder votre structure de données <b>le plus plat possible</b>.
						</p>
					</section>

					<section class="section-fb text-left">
						<h2>Organisation "Flat" </h2>
						<br>
						<pre><code class="javascript" data-trim >
{
  "chats": {
    "one": {
      "title": "Historical Tech Pioneers",
      "messages": {
        "m1": {
            "sender": "ghopper",
            "message": "Relay malfunction found. Cause: moth."
        },
        "m2": { ... },
        // a very long list of messages
      }
    },
    "two": { ... }
  }
}
						</code></pre>
						<p>
							suite ...
						</p>
					</section>

					<section class="section-fb text-left">
						<h2>Organisation "Flat" </h2>
						<br>
						<p>
							Par exemple , la liste des titres des conversations de chat nécessite l'arbre des chats entiers , y compris tous les membres et messages. Tous devra être téléchargés sur le client .
						</p>
						<p>
							Il vaut donc mieux 'aplatir' votre structure de donnée pour permettre une selection plus fine, et donc obtenir une plus grande réactivité de l'interface du client.
						</p>
						<p>
							Voici une solution possible qui aurait permis une meilleures itération des données stockées:
						</p>
					</section>

					<section class="section-fb text-left">
						<h2>Organisation "Flat" </h2>
						<br>
						<pre><code class="javascript" data-trim >
{
  "chats": {
    "one": {
      "title": "Historical Tech Pioneers",
      "lastMessage": "ghopper: Relay malfunction found. Cause: moth.",
      "timestamp": 1459361875666
    },
    "two": { ... },
    "three": { ... }
  },

  "members": {
    "one": {
      "ghopper": true,
      "alovelace": true,
      "eclarke": true
    },
    "two": { ... },
    "three": { ... }
  },

  "messages": {
    "one": {
      "m1": {
        "name": "eclarke",
        "message": "The relay seems to be malfunctioning.",
        "timestamp": 1459361875337
      },
      "m2": { ... },
      "m3": { ... }
    },
    "two": { ... },
    "three": { ... }
  }
}
						</code></pre>
					</section>

					<section class="section-fb text-left">
						<h2>Organisation "Flat" </h2>
						<br>
						<p>
							Pour plus de détails sur l'organisation des données dans Firebase, se référer à la documentation officiel qui est très complète pour autant que l'on prenne le temps de bien lire chaque informations.
						</p>
						<p>
							<a href="https://firebase.google.com/docs/database/web/structure-data">https://firebase.google.com/docs/database/web/structure-data</a>
						</p>
					</section>
				</section>

				<section>
					<section data-background-color="#039be5">
						<img height="350px" src="https://s3.amazonaws.com/media-p.slid.es/uploads/559385/images/2976546/Firebase_16-logo.png" alt="">
						<h2>Firebase Save, update, <br>or delete data</h2>
					</section>

					<section class="section-fb text-left">
						<h2>Sauvegarder des datas</h2>
						<br>
						<p>
							Il existe 3 principal méthodes pour écrire dans la base de donnée Firebase.
						</p>
						<ul>
							<li><b>set()</b>: écrit ou remplace les infos d'un noeud spécifique.</li>
							<li><b>push()</b>ajoute un noeud à une collection ou sous-noeud avec une ID générée par Firebase. </li>
							<li><b>update()</b>mettre à jour la valeur d'une clé d'un noeud spécifique sans changer le reste des datas</li>
						</ul>
					</section>

					<section class="section-fb text-left">
						<h2>Exemples basic: </h2>
						<br>
						<pre><code class="javascript" data-trim >
function writeUserData(userId, name, email, imageUrl) {
  firebase.database().ref('users/' + userId).set({
    username: name,
    email: email,
    profile_picture : imageUrl
  });
}

function writeNewPost(uid, username, picture, title, body) {
  // A post entry.
  var postData = {
    author: username,
    uid: uid,
    body: body,
    title: title,
    starCount: 0,
    authorPic: picture
  };
  // Get a key for a new Post.
  var newPostKey = firebase.database().ref().child('posts').push().key;
  // Write the new post's data simultaneously in the posts list and the user's post list.
  var updates = {};
  updates['/posts/' + newPostKey] = postData;
  updates['/user-posts/' + uid + '/' + newPostKey] = postData;
  return firebase.database().ref().update(updates);
}
						</code></pre>
					</section>

					<section class="section-fb text-left">
						<h2>Supprimer des datas </h2>
						<br>
						<p>
							Pour supprimer des noeuds de la base de donnée Firebase, il existe une méthode remove() mais un simple update() avec la valeur NULL supprimera automatiquement le noeud.
						</p>
						<p>
							Pour plus de détails sur les méthodes Firebase, ce référer à la documentation: <br>
							<a href="https://firebase.google.com/docs/database/web/save-data">https://firebase.google.com/docs/database/web/save-data</a>
						</p>
					</section>
				</section>

				<section>
					<section data-background-color="#039be5">
						<img height="350px" src="https://s3.amazonaws.com/media-p.slid.es/uploads/559385/images/2976546/Firebase_16-logo.png" alt="">
						<h2>Firebase Retrieve data</h2>
					</section>

					<section class="section-fb text-left">
						<h2>Retrouver les datas dans Firebase</h2>
						<br>
						<p>
							Pour retrouver les datas stockées dans Firebase, on utilise les fonction asynchrone fournis par l'outil. Les Listeners !
						</p>
						<p>
							Et voici la liste des events que l'on peut associer:
						</p>
						<ul>
							<li><b>value</b>: lire et écoute les changement d'un noeud.</li>
							<li><b>child_added</b>:  retrouver une liste d'item ajouter.</li>
							<li><b>child_changed</b>: écouter les changement d'un item dans une liste</li>
							<li><b>child_removed</b>: écouter lors d'une suppression d'item.</li>
							<li><b>child_moved</b>: écouter lors du déplacement d'un item.</li>
						</ul>
					</section>

					<section class="section-fb text-left">
						<h2>Retrouver les datas dans Firebase</h2>
						<br>
						<p>
							L'exemple suivant montre une application de blogging sociale récupérer le nombre d' étoiles d'un poste dans la base de données.
						</p>
						<pre><code class="javascript" data-trim >
// récupérer la référence starCount
// d'un post spécifique (posteId) et y stocker dans starCountRef
var starCountRef = firebase.database().ref('posts/' + postId + '/starCount');

// Créer un listener avec l'event 'value'
// pour récupérer la valeur contenu dans la référence
starCountRef.on('value', function(snapshot) {

    // les valeur sont contenu dans snapshot.val()
    // et passée à une fonction pour être traitée plus loin...
    updateStarCount(postElement, snapshot.val());

});
						</code></pre>
					</section>

					<section class="section-fb text-left">
						<h2>Retrouver les datas dans Firebase</h2>
						<br>
						<p>
							Tous les events Firebase fonctionne sur le même principe.
							<br>Il est donc très facile de manipuler ses données pour autant que la structure soit bien pensée (use case).
						</p>
						<p>
							Vous trouverez les détails d'utilisation de chaque events, ainsi que toutes les paramètres de filtrage des données possible dans la documentation Firebase.
						</p>
						<p>
							<a href="https://firebase.google.com/docs/database/web/retrieve-data">https://firebase.google.com/docs/database/web/retrieve-data</a>
						</p>
					</section>

					<section class="section-fb text-left">
						<h2>Fonctions de tris et filtres Firebase</h2>
						<br>
						<p>
							Firebase propose des fonctions de tris et de filtrage des données.
						</p>
						<p>
							Order by:
						</p>
						<ul>
							<li><b>orderByChild()</b>: results by the value of a specified child key</li>
							<li><b>orderByKey()</b>: results by child keys</li>
							<li><b>orderByValue()</b>: results by child values</li>
						</ul>
						<br>
						<pre><code class="javascript" data-trim >
var myUserId = firebase.auth().currentUser.uid;
var userPostsRef = firebase.database().ref('user-posts/' + myUserId);
var topUserPostsRef = userPostsRef.orderByChild('starCount');
						</code></pre>
					</section>

					<section class="section-fb text-left">
						<h2>Fonctions de tris et filtres Firebas</h2>
						<p>
							Filtering data:
						</p>
						<ul>
							<li><b>limitToFirst()</b>: Sets the maximum number of items to return from the beginning of the ordered list of results.</li>
							<li><b>limitToLast()</b>: Sets the maximum number of items to return from the end of the ordered list of results.</li>
							<li><b>startAt()</b>: Return items greater than or equal to the specified key or value, depending on the order-by method chosen.
							<li><b>endAt()</b>: Return items less than or equal to the specified key or value, depending on the order-by method chosen.</li>
							<li><b>equalTo()</b>: Return items equal to the specified key or value, depending on the order-by method chosen.</li>
						</ul>
						<br>
						<pre><code class="javascript" data-trim >
var recentPostsRef = firebase.database().ref('posts').limitToLast(100);
						</code></pre>
					</section>
				</section>

				<section>
					<section data-background-color="#039be5">
						<img height="350px" src="https://s3.amazonaws.com/media-p.slid.es/uploads/559385/images/2976546/Firebase_16-logo.png" alt="">
						<h2>Firebase <br>User Authentication</h2>
					</section>

					<section class="section-fb text-left">
						<h2>firebase.auth()</h2>
						<br>
						<p>
							Firebase met à disposition un excellent outils d'authentification des utilisateurs. Il permet une multitude de système d'authentification:
						</p>
						<p>
							Google; Facebook; Twiter; Github; Email & password; user anonyme; custome auth système.
						</p>
					</section>

					<section class="section-fb text-left">
						<h2>Auth. with Google</h2>
						<br>
						<p>
							Comme pour la base de donnée, il faut instencier la méthode d'authentification de Firebase pour pouvoir l'utiliser.
						</p>
						<pre><code class="javascript" data-trim >
let googleProvider = new firebase.auth.GoogleAuthProvider();
						</code></pre>
					</section>

					<section class="section-fb text-left">
						<h2>Auth. with Google</h2>
						<br>
						<pre><code class="javascript" data-trim >
let googleProvider = new firebase.auth.GoogleAuthProvider();
firebase.auth().signInWithPopup(googleProvider)
.then(function(result) {
  // This gives you a Google Access Token.
  // You can use it to access the Google API.
  let token = result.credential.accessToken;
  // The signed-in user info.
  let user = result.user;
  // ...
}).catch(function(error) {
  // Handle Errors here.
  let errorCode = error.code;
  let errorMessage = error.message;
  // The email of the user's account used.
  let email = error.email;
  // The firebase.auth.AuthCredential type that was used.
  let credential = error.credential;
  // ...
});
						</code></pre>
						<br>
						<h4>
							Pour se logout:
						</h4>
						<pre><code class="javascript" data-trim >
firebase.auth().signOut().then(function() {
  // Sign-out successful.
}, function(error) {
  // An error happened.
});
						</code></pre>
					</section>

					<section class="section-fb text-left">
						<h2>Récupérer les info de l'user</h2>
						<br>
						<p>
							Pour récupérer les informations concernant l'utilisateur vous pouvez utiliser cette méthode:
						</p>
						<pre><code class="javascript" data-trim >
firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
    // User is signed in.
  } else {
    // No user is signed in.
  }
});
						</code></pre>
						<pre><code class="javascript" data-trim >
var user = firebase.auth().currentUser;

if (user) {
  // User is signed in.
} else {
  // No user is signed in.
}
						</code></pre>
					</section>

					<section class="section-fb text-left">
						<h2>Récupérer les info de l'user</h2>
						<br>
						<pre><code class="javascript" data-trim >
var user = firebase.auth().currentUser;
var name, email, photoUrl, uid;

if (user != null) {
  name = user.displayName;
  email = user.email;
  photoUrl = user.photoURL;
  uid = user.uid;
}
						</code></pre>
						<br>
						<p>
							Il existe beaucoup de méthodes qui on chacune des champ d'application diverses. Je vous recommande de prendre le temps de consulter la doc afin de prendre connaissance des possibilité qu'offre les système d'authentification de Firebase.
						</p>
						<p>
							Doc Firebase Auth: <a href="https://firebase.google.com/docs/auth/">https://firebase.google.com/docs/auth/</a>
						</p>
					</section>
				</section>

				<section>
					<section data-background-color="#039be5">
						<img height="350px" src="https://s3.amazonaws.com/media-p.slid.es/uploads/559385/images/2976546/Firebase_16-logo.png" alt="">
						<h2>Firebase</h2>
						<h3>Gestion des droits et sécurité</h3>
					</section>

					<section class="section-fb text-left">
						<h2>Droit en écriture et lecture</h2>
						<br>
						<p>
							Pour définir les droits d'écriture et de lecture des datas stockées sur Firebase, rendez-vous sous l'onglet "Règle" dans la section "Database"
						</p>
						<p>
							Doc officiel:
							<br><a href="https://firebase.google.com/docs/database/security/">https://firebase.google.com/docs/database/security/</a>
						</p>
					</section>
				</section>

				<section data-background-color="#039be5">
					<h2>Des questions?</h2>
				</section>
				<section data-background-color="#039be5">
					<h2>Fin ;-)</h2>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
